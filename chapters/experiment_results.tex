\chapter{Analysis Of Generation Quality on Existing Datasets}
In this chapter, we will analyze the generation quality through fine-tuning the pretrained language models such as GPT2/Dialo-GPT on the existing three Datasets(Reddit,Conan and Gab). We report the respective performances while evaluating on certain generation metrics. We further report the problems with the existing datasets and thereby explaining the poor generation quality of language-models trained on them.

\section{Experiment Settings}
For each of the three datasets, the hate-counter part was concatenated for fine-tuning. Stratification split of the  data into $8(train):1(val):1(test)$. This was kept fixed throughout the experiment. Training was done for at max $10$ epochs (for transformers) and the model was saved at best validation score.


\section{Intra-Model Performance}
\par We fine-tuned the models on all the three datasets individually using the small and medium versions of GPT2 and DialoGPT models. 
We compare the results of the two models (one with GPT2, one with DialoGPT2) with the results reported in the original paper and we found out that the scores have improved substantially.

\subsection{Performance on CONAN}

\par The responses generated by fine-tuning the Language-Models on CONAN Dataset are given in \ref{example-1} The responses generated by GPT-2 are comparatively of better quality.
\begin{table}[h]
\begin{tabular}{ |p{3cm}||p{12cm}|  }
 \hline
 \textbf{Model} & \textbf{Text}\\
 \hline
 Hate-Speech   & Not all Muslims are terrorists, but all terrorists are Muslims.   \\
 \hline
 GPT2-10iter & The vast majority of Muslims denounce terrorism and ISIS. Don't believe the sensationalist media stories that focus on a select few extreme cases, and under-report on non-muslim terrorist activities.\\
 \hline 
 GPT2-20iter & And tell me, how long did you spend studying the Quran? How long did YOU spend living with, eating with and talking with Muslims and their faith to understand them and Islam? How is it that you happen to know what Islam truly is?\\
 \hline 
 DialoGPT & So 1.6 billion people could be terrorists?\\
 \hline
\end{tabular}
\begin{tabular}{ |p{3cm}||p{12cm}|  }
 \hline
 \hline
 Hate-Speech   & Our women and girls are frequently victim of rapes, because our government brought Muslims in our country. \\
 \hline
 GPT2-10iter & Why do you link rapist crimes and Muslim people? Do you have anny proofs for that?\\
 \hline 
 GPT2-20iter & That is what the headlines suggest BUT actual cases where migrants are the abuser is just a drop in the ocean compared to the total number of cases.\\
 \hline 
 DialoGPT & The ONS says 55\% of victims are assaulted by a partner or ex partner. Lock up all married people (and divorcees)!\\
 \hline
\end{tabular}
\caption{Responses generated by different LMs}
\label{example-1}
\end{table}

\newpage
The automated evaluation metrics calculated on the CONAN-test-data is given in \ref{example-2}.
\begin{table}[h]
\centering
\begin{tabular}{ |c||c|c|c|}
 \hline
 \textbf{Metric} & \textbf{GPT2} & \textbf{GPT2-20iter} & \textbf{DIALOGPT}\\
 \hline
  BLEU-0   &  0.2255 &  \textbf{0.4784} & 0.3549\\
 \hline
  BLEU-4 & 0.3343 & \textbf{0.5712} & 0.4959\\
 \hline 
  METEOR & 0.3523 & \textbf{0.5920} & 0.4404\\
 \hline 
  Perplexity & \textbf{8.1823} & 10.1965 & 8.7566\\
  \hline
\end{tabular}
\caption{Metrics computed on CONAN Test-Data}
\label{example-2}
\end{table}

\subsection{Performance on Reddit}
\par The responses generated by fine-tuning the Language-Models on Reddit Dataset are given in \ref{example-4} The responses generated by GPT-2 are comparatively of better quality.
\begin{table}[h]
\begin{tabular}{ |p{3cm}||p{12cm}|  }
 \hline
 \textbf{Model} & \textbf{Text}\\
 \hline
 Hate-Speech   &  No, because she's literally a retard and hasn't come to terms with that fact just yet.   \\
 \hline
 GPT2 & The use of that word is offensive towards people with mental disabilities and is unacceptable.\\
 \hline 
 DialoGPT & Please refrain from using hateful ableist language in your posts.  It does nothing to enhance your argument or the discussion in this sub.\\
 \hline
\end{tabular}
\begin{tabular}{ |p{3cm}||p{12cm}|  }
 \hline
 \hline
 Hate-Speech   &   Anyone calling themselves a feminist today is either an anachronistic moron, or a female supremacist cunt. \\
 \hline
 GPT2 & 'Cunt' is a pejorative word that is demeaning and hateful towards women, and should not be used.\\
 \hline 
 DialoGPT & The use of the word 'cunt' is offensive as its a direct attack to someone based on their gender. Refrain from such words\\
 \hline
\end{tabular}
\caption{Responses generated by different fine-tuned LMs on Reddit}
\label{example-4}
\end{table}
\newpage
\par The automated evaluation metrics calculated for the test-data is given in \ref{example-3}.

\begin{table}[h]
\centering
\begin{tabular}{ |c||c|c|}
 \hline
 \textbf{Metric} & \textbf{DIALOGPT} & \textbf{GPT2} \\
 \hline
  BLEU-0 &  0.027 &  \textbf{0.0384}\\
 \hline
  BLEU-4 & 0.1806 & \textbf{0.1899} \\
 \hline 
  METEOR & \textbf{0.1736} & 0.1679 \\
 \hline 
  Perplexity & 7.597 & \textbf{7.213}\\
  \hline
\end{tabular}
\caption{Metrics computed on Reddit Test-Data}
\label{example-3}
\end{table}


\subsection{Performance on GAB}

\par The responses generated by fine-tuning the Language-Models on GAB Dataset are given in \ref{example-5} The responses generated by GPT-2 are comparatively of better quality.

\begin{table}[h]
\begin{tabular}{ |p{3cm}||p{12cm}|  }
 \hline
 \textbf{Model} & \textbf{Text}\\
 \hline
 Hate-Speech   &  Hey Lee, do you fuck niggers for fun or is it because no White man would fuck you with a dog dick?   \\
 \hline
 GPT2 & Use of the slurs here is unacceptable in discourse as it demeans and insults and alienates others.\\
 \hline 
 DialoGPT & Use of the n-word is unacceptable in our discourse as it demeans and insults blacks.\\
 \hline
\end{tabular}
\begin{tabular}{ |p{3cm}||p{12cm}|  }
 \hline
 \hline
 Hate-Speech   & How retarded is it to proudly wave the flag of the country you are supposedly fleeing. \\
 \hline
 GPT2 & Use of the r-word is unacceptable in our discourse as it demeans and insults people with mental disabilities.\\
 \hline 
 DialoGPT & Using a person's mental disability as an insult only shows how narrow minded you are.\\
 \hline
\end{tabular}
\caption{Responses generated by different fine-tuned LMs on GAB}
\label{example-5}
\end{table}

\par The automated evaluation metrics calculated for the test-data is given in \ref{example-6}.

\begin{table}[h]
\centering
\begin{tabular}{ |c||c|c|}
 \hline
 \textbf{Metric} & \textbf{DIALOGPT} & \textbf{GPT2} \\
 \hline
  BLEU-0 &  0.027 &  \textbf{0.0386}\\
 \hline
  BLEU-4 & 0.2386 & \textbf{0.2517} \\
 \hline 
  METEOR & 0.1636 & \textbf{0.2148} \\
 \hline 
  Perplexity & 7.123 & \textbf{6.016}\\
  \hline
\end{tabular}
\caption{Metrics computed on GAB-Test-Data}
\label{example-6}
\end{table}
\newpage
\section{Inter-Model Performance}

\par We also evaluate models fine-tuned in one-setting and evaluated in the other. Given below are the cross-model statistics.

\begin{table}[h]
\centering
\begin{tabular}{|p{2cm}||p{1.5cm}|p{1.5cm}|p{1.5cm}|p{1.5cm}|p{1.5cm}|p{1.5cm}|}
 \hline
 Train & \multicolumn{6}{|c|}{Test} \\
 \hline
 BLEU-4 & \multicolumn{2}{|c|}{CONAN} & \multicolumn{2}{|c|}{Reddit} & \multicolumn{2}{|c|}{Gab}\\
 SCORE &  DIALO  & GPT & DIALO &  GPT  & DIALO & GPT\\
 \hline
 CONAN &  \textbf{0.49}  & \textbf{0.57} & 0.17 &  0.16  & 0.186 & 0.1847\\
 \hline
 REDDIT & 0.226  & 0.224 & 0.18 &  0.197  & 0.20 & 0.1899\\
 \hline
 GAB &  0.23  & 0.19 & \textbf{0.214} &  \textbf{0.218}  & \textbf{0.23} & \textbf{0.2517}\\
 \hline
\end{tabular}
\caption{Responses generated by different fine-tuned LMs on GAB}
\label{example-7}
\end{table}

\section{Observations on results of Fine-Tuned(Inter+Intra) Models}
\par Our evaluations on Cross Model revealed that a model trained on GAB and tested on Reddit performed better than model trained and tested on Reddit itself. This is primarily because of the type of intervention response is similar in both of the datasets but the average length of labeled hate-speech for GAB is shorter than that of Reddit.

\newpage
\section {Problems with existing Datasets}
\begin{itemize}
    \item We observed large-language models like GPT2 were able to generate diverse responses in case of CONAN dataset but the case was not the same for Reddit and GAB.
    \item The generated responses were dataset dependent. While CONAN contains better human interventions, it contains hate-speech against single-community.
    \item On the other side, Reddit being a more generic dataset comprising hate-speech targeting various communities had interventions of only one type(Denouncing Hate Speech).
    \item Both of the datasets either lack in terms of addressing the different communities or the responses being pretty generic and less diverse.
\end{itemize} 

This calls for creation of a data-instances which can aid the generative models learn to counter-argue a given hate-instance. We will describe our proposed method for data-crawling and the system architecture for the counter-speech generation model in the next section. Additionally we will provide a detoxification algorithm so that the generative model does not provide offensive or slur words as response upon given an argument that potentially contains foul language such as abusive or racial slures.

% \section{Plug and Play Models}
% \par We carried out experiments with different attribute models to steer the generated response in the direction of a relevant counter-speech. Some of attribute models we used are described below:

% \subsection{PPLM+Positive-Sentiment Discriminator}
% \par The discriminator is trained on SST dataset which comprises of thousands of movie-reviews labelled as positive and negative. The discriminator steers the GPT in the direction of generating very-positive response when conditioned upon the given hate-speech as input. Some of the generated results are shown in \ref{example-8}.

% \begin{table}[h]
% \begin{tabular}{ |p{8cm}||p{8cm}|  }
%  \hline
%  \textbf{Hate-Speech} & \textbf{LM-GPT2,Discrim(very-positive)}\\
%  \hline
%     Not all Muslims are terrorists, but all terrorists are Muslims. & There is a slightly higher proportion of Muslims than Christians (a couple of percentage points higher than white British- certainly not a majority) but the vast majority of Muslims are peaceful, law-abiding and hard-working, not 'thugs'.\\
%  \hline
%  Our women and girls are frequently victim of rapes, because our goverment brought Muslims in our country. & The vast majority of rapes are committed in the home, by someone the victim knows, or by a partner. There are numerous examples of rape culture in this country.\\
%  \hline
%  Doesn't the Koran say: 'Murder all the non-Muslims wherever they hide'? & The vast majority of verses in the Qu'ran do not advocate killing or murdering non-believers. The killing of a small percentage of people does not represent a sweeping and generalization of a religion to entire communities.\\
%  \hline
% \end{tabular}
% \caption{PPLM(GPT2+Discrim(Very-Positive)}
% \label{example-8}
% \end{table}

% \newpage

% \subsection{PPLM+HS/CS Discriminator}
% \par The discriminator is trained on Reddit dataset having hate-speech and counter-speech as classes to steer upon. The F1 score of the discriminator was recorded at 0.95 with 96\% accuracy. The discriminator steers the GPT in the direction of generating a counter response when conditioned upon the given hate-speech as input. Some of the generated results are shown in \ref{example-9}.

% \begin{table}[h]
% \begin{tabular}{ |p{8cm}||p{8cm}|  }
%  \hline
%  \textbf{Hate-Speech} & \textbf{LM-DIALOGPT,Discrim(Counter-Speech)}\\
%  \hline
%   But here is the thing, I connect to him because I am similar. Because you have a well-developed sense of empathy. These people are emotionally stunted and do not - they simply can't put themselves into the shoes of another because they are emotionally retarded. & It's not that they are emotionally stunted, they're just not interested in making it to the front page.\\
%  \hline
% I wonder if all these retards will realize one day, when the entire planet turns conservative, if they were on the wrong side of history?& It's a real possibility I didn't consider, but there's no evidence that all of the people on the Earth were on the wrong sides of history.\\
%  \hline
%  If you are a lesbian, you are a woman, not a man. If you claim to be a he/him lesbian you are either a man who just wants to use lesbian instead of gay, or you are a retard.&You clearly have severe mental health issues. You're confusing gender and sexuality, it just doesn't make sense to me.\\
%  \hline
%  Get a load of this retard & Haha he has been doing this for years now!\\
%  \hline
% \end{tabular}
% \caption{PPLM(DIALOGPT+Discrim(Counter-Speech)}
% \label{example-9}
% \end{table}
% \newpage
% \subsection{PPLM+HS/CS Discrim + F/NF Discrim}
% \par Here we deploy two discriminators in a hierarchial fashion. The first discriminator is trained on Reddit dataset having hate-speech and counter-speech as classes to steer upon. The F1 score of the first discriminator was recorded at 0.95 with 96\% accuracy. The second discriminator was trained upon ICWSM dataset. The ICWSM dataset was grouped into two categories of counter-speech (Factual Based/Non-Factual Based). Presenting facts, Pointing out Hypocrisy, Positive Tone were clubbed into a single group and warning of consequences,showing affiliation and denouncing of hate speech were clubbed into another.The F1 score of the second discriminator was recorded at 0.9 with 83.3\% accuracy.
% Some of the generated results are shown in \ref{example-10}.

% \begin{table}[h]
% \begin{tabular}{ |p{8cm}||p{8cm}|  }
%  \hline
%  \textbf{Hate-Speech} & \textbf{LM-GPT,Discrim(HS/CS+F/NF)}\\
%  \hline
%   Yes, I very much think that the right to vote should be restricted to white, property owning men.& (Control-Factual)I don't care how they choose to identify as a person, or they can be anything they want to be. That's just a basic human right that has nothing to do with race or religion and everything to do with self determination.\\
%  \hline
%  Yes, I very much think that the right to vote should be restricted to white, property owning men.& (Control-NonFactual) That's the basic trick that the Republicans have been imposing upon the American People since ages.\\
%  \hline
% \end{tabular}
% \caption{PPLM(DIALOGPT+Discrim(Counter-Speech)}
% \label{example-10}
% \end{table}